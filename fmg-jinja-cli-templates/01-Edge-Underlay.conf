{% import 'Globals' as globals with context %}

config system interface
  {% for i in globals.profiles[profile].interfaces %}
  edit "{{i.name}}"
    {% if i.ip == 'dhcp' %}
    set mode dhcp
    {%  elif i.ip %}
    set mode static
    set ip {{ i.ip }}
    {% endif %}
    set allowaccess ping
  next
  {% endfor %}
end

config system zone
  edit "lan"
    {% set lan_intf = [] %}
    {% for i in globals.profiles[profile].interfaces if i.role == 'lan'  %}
    {{  lan_intf.append(i.name) or "" }}
    {% endfor %}
    set interface {{ lan_intf|join(' ') }}
  next
end

config system global
    set hostname {{ hostname }}
end
